sheets:
  - id: budget-summary
    title: "Overall Balance"
    spreadsheetId: ${env:SHEETS_DEFAULT_SPREADSHEET_ID}
    tab: Summary
    mode: clear-and-replace
    syncTarget: default
    cron: "0 3 * * *"
    source:
      type: balances
      options:
        includeHidden: false
    transform:
      columns:
        - label: Account
          value: accountName
        - label: Balance
          value: "${balance/100}"
        - label: Last Updated
          value: "=NOW()"
    events:
      entities: account
      types: account.updated
      debounceMs: 5000
  - id: recent-transactions
    spreadsheetId: ${env:SHEETS_DEFAULT_SPREADSHEET_ID}
    tab: Transactions
    mode: upsert
    keyColumns:
      - Transaction ID
    syncTarget: default
    source:
      type: transactions
      options:
        days: 14
        includeScheduled: false
    transform:
      columns:
        - label: Transaction ID
          value: transactionId
        - label: Date
          value: "${formatDate(date, 'yyyy-MM-dd')}"
        - label: Payee
          value: payee
        - label: Amount
          value: "${amount/100}"
        - label: Category
          value: category
        - label: Memo
          value: "${coalesce(memo, '')}"
      postProcess:
        sortBy:
          - column: Date
            direction: desc
    events:
      entities: transaction
      types: transaction.created,transaction.updated
      debounceMs: 3000
